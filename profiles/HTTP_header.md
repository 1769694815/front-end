### 写在前面的话
> 缓存对于web开发有重要作用，尤其是大负荷web系统开发中。
> 想了解更多关于性能优化的知识,请移步[传送门](./前端性能优化.md)

## 缓存
* 缓存的分类：服务器缓存，第三方缓存，浏览器缓存等。
* 浏览器缓存是代价最小的，因为浏览器缓存依赖的是客户端，而几乎不耗费服务器端的资源(极端情况下相当于纯静态页面)。
* 让浏览器做缓存需要给浏览器发送指定的Http头，告诉浏览器缓存多长时间，或者坚决不要缓存。

## HTTP-header
### Expires（过期时间）
* HTTP头信息Expires（过期时间） 属性是HTTP控制缓存的基本手段
* 是一个绝对时间间隔
* 作用：告诉缓存器相关副本在多长时间内是新鲜的。过了这个时间，缓存器就会向源服务器发送请求，检查文档是否被修改。
* 几乎所有的缓存服务器都支持Expires（过期时间）属性
* 基于客户最后查看副本的时间（最后访问时间）或者根据服务器上文档最后被修改的时间
* 对于设置静态图片文件（例如导航栏和图片按钮）可缓存特别有用；因为这些图片修改很少，你可以给它们设置一个特别长的过期时间，这会使你的网站对用户变得相应非常快
* 对于控制有规律改变的网页也很有用，例如：你每天早上6点更新新闻页，你可以设置副本的过期时间也是这个时间，这样缓存服务器就知道什么时候去取一个更新版本，而不必让用户去按浏览器的“刷新”按钮。
* 过期时间头信息属性值只能是HTTP格式的日期时间，其他的都会被解析成当前时间“之前”，副本会过期
* HTTP的日期时间必须是格林威治时 间（GMT），而不是本地时间。
* 举例：Expires: Fri, 30 Oct 1998 14:19:41
* 虽然过期时间属性非常有用，但是它还是有些局限，
	* 首先：是牵扯到了日期，这样Web服务器的时间和缓存服务器的时间必须是同步的，如果有些不同步，要么是应该缓存的内容提前过期了，要么是过期结果没及时更新。
	* 如果你设置的过期时间是一个固定的时间，如果你返回内容的时候又没有连带更新下次过期的时间，那么之后所有访问请求都会被发送给源Web服务器，反而增加了负载和响应时间

### Cache-Control（缓存控制）
* 让网站的发布者可以更全面的控制他们的内容，并定位过期时间的限制。
* max-age=[秒] — 执行缓存被认为是最新的最长时间。
	* 相对时间，不是绝对时间
	* 单位是秒：从请求时间 开始到过期时间之间的秒数。
* s-maxage=[秒] — 类似于max-age属性，除了他应用于共享（如：代理服务器）缓存
* public — 标记认证内容也可以被缓存，一般来说： 经过HTTP认证才能访问的内容，输出是自动不可以缓存的；
* no-cache — 强制每次请求直接发送给源服务器，而不经过本地缓存版本的校验。这对于需要确认认证应用很有用（可以和public结合使用），或者严格要求使用最新数据 的应用（不惜牺牲使用缓存的所有好处）；
* no-store — 强制缓存在任何情况下都不要保留任何副本
* must-revalidate — 告诉缓存必须遵循所有你给予副本的新鲜度的
* proxy-revalidate — 和 must-revalidate 类似，除了他只对缓存代理服务器起作用
举例:
Cache-Control: max-age=3600, must-revalidate
给静态资源(HTML文件，图片文件等）的Repsone加上Expires/Cache-Control Header是很有效的一招。如果HTTP Response中有Expires这样的Header的话，浏览器会Cache这个资源，理想状况下（注意，只是理想状况），在Expire Date之前，不会再发HTTP请求给Server要这个资源，不过Expires的值只能是一个固定日期，比如“Thu 27 Nov 2008 07:00:00 GMT”，不能是一个类似“从现在开始之后10年”这样一个随机浮动的值，如果要这样的效果，可以用Cache-Control这样的Header，如果 HTTP Response中有这样的Header:“Cache-Control: max-age = 100”，表示这个资源在cache中的最大寿命是100秒。一般说来这种静态文件永远不应该过期，如果真的要给这个Cache加上一个期限，那我希望是 ——一万年，“Cache-Control: max-age = 315360000000”
其实就应该给Expires设一个永远不会过期的时间，比如你现在有一个文件叫logo.gif，需要用一个新的logo的时候，你不要去 覆盖原来的文件，而把新的logo存成logo_v2.gif，让相关网页引用新的logo_v2.gif，这样可以让新老网页同时工作，实在犯不上为了 节省存储空间覆盖原有文件。

对Apache服务器，使用mod_expires，在httpd.conf或者.htaccess中加上